AC_INIT([libxayagame], [0.1])
AM_INIT_AUTOMAKE

AC_CONFIG_MACRO_DIR([m4])
AC_CONFIG_HEADERS([config.h])

AC_PROG_CXX
AM_PROG_AR

AC_LANG([C++])
LT_INIT

AX_CXX_COMPILE_STDCXX([14], [noext])
AX_CHECK_COMPILE_FLAG([-Wall], [CXXFLAGS+=" -Wall"])
AX_CHECK_COMPILE_FLAG([-Werror], [CXXFLAGS+=" -Werror"])
AX_CHECK_COMPILE_FLAG([-pedantic], [CXXFLAGS+=" -pedantic"])
AX_CHECK_COMPILE_FLAG([-Wno-deprecated], [CXXFLAGS+=" -Wno-deprecated"])

CXXFLAGS+=" -DGLOG_NO_ABBREVIATED_SEVERITIES"

PKG_CHECK_MODULES([JSONCPP], [jsoncpp])
PKG_CHECK_MODULES([JSONRPCCLIENT], [libjsonrpccpp-client])
PKG_CHECK_MODULES([JSONRPCSERVER], [libjsonrpccpp-server])
PKG_CHECK_MODULES([GLOG], [libglog])
PKG_CHECK_MODULES([GFLAGS], [gflags])
PKG_CHECK_MODULES([GTEST], [gmock gtest_main])
PKG_CHECK_MODULES([PROTOBUF], [protobuf])
PKG_CHECK_MODULES([SQLITE3], [sqlite3],
  [SQLITE3_CFLAGS+=" -DSQLITE_ENABLE_SESSION -DSQLITE_ENABLE_PREUPDATE_HOOK"])
PKG_CHECK_MODULES([ZMQ], [libzmq])

AC_CONFIG_FILES([
  Makefile \
  xayagame/Makefile \
  mover/Makefile \
  mover/gametest/Makefile
])

AC_OUTPUT

echo
echo "CXXFLAGS: ${CXXFLAGS}"
